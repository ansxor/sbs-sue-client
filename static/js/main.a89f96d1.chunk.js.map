{"version":3,"sources":["components/TabButton.jsx","components/UserTabButton.jsx","components/TabList.jsx","components/UploadTab.jsx","components/ActivityTab.jsx","components/CategoryItem.jsx","components/ContentItem.jsx","components/CategoryTab.jsx","components/Sidebar.jsx","parse.js","components/TestPageView.jsx","components/Home.jsx","App.jsx","reportWebVitals.js","index.js"],"names":["TabButton","props","onClick","selectEvent","icon","className","selected","UserTabButton","useState","userImg","setUserImg","useEffect","usertoken","fetch","headers","authorization","then","res","json","data","avatar","catch","err","console","error","style","display","src","alt","TabList","selectedTab","setSelectedTab","map","i","memo","UploadTab","uploadedImage","setUploadedImage","visible","changeHeader","onChange","event","file","target","files","URL","createObjectURL","type","accept","maxWidth","maxHeight","margin","ActivityTab","CategoryItem","clickEvent","id","name","ContentItem","to","textDecoration","viewCache","CategoryTab","categoryID","setCategoryID","categoryMetadata","setCategoryMetadata","categories","setCategories","contents","setContents","loadingContent","setLoadingContent","switchCategory","newId","switchPage","log","changePage","cachedCategoryID","category","content","metadata","params","JSON","stringify","parentIds","sort","url","parentId","pop","filter","x","cursor","c","Sidebar","tab","setTab","headerDisplay","setHeaderDisplay","flex","overflow","Parse","lang","create","document","createElement","createText","createTextNode","creator","tag","node","newEvent","createEvent","initEvent","defaultProtocol","window","location","protocol","getPath","decodeURIComponent","hash","substr","split","options","append","parent","child","branch","nodes","forEach","appendChild","text","lineBreak","line","invalid","reason","title","textContent","code","args","language","setAttribute","block","icode","audio","video","youtube","preview","match","getYoutubeID","link","div","href","backgroundImage","time","end","loop","callback","XMLHttpRequest","open","onload","status","parse","responseText","items","e","send","getYoutube","snippet","channelTitle","ifc","onclick","preventDefault","dispatchEvent","iframe","stop","innerHTML","bg","opt","color","root","createDocumentFragment","bold","italic","underline","strikethrough","heading","level","quote","cite","list","undefined","listStyleType","item","index","test","toLowerCase","urlProtocol","removeAttribute","hash1","hash2","n","getElementsByName","scrollIntoView","table","opts","container","row","cell","h","rs","rowSpan","cs","colSpan","backgroundColor","a","textAlign","image","stack","pre","align","arg","superscript","subscript","anchor","spoiler","button","this","getAttribute","box","skipNextLineBreak","textBuffer","curr","output","startOfLine","leadingSpaces","blocks","cache","editorCache","scan","init","scanFunc","myBlocks","used","top","length","restore","pos","eatChar","chr","matchNext","str","readUrl","allow","start","isUrlChar","substring","stackContains","top_is","endBlock","flushText","addBlock","addLineBreak","addText","endAll","startBlock","tryGetCached","push","isUrlStart","make","findUnusedCached","codeInput","lineStart","charAt","tags","sub","sup","endLine","readEnv","closeAll","doMarkup","headingLevel","addMulti","char_in","trim","count","inBrackets","big","eaten","columns","cells","rowspans","span","header","startCell","replace","indexOf","codeText","readLink","readTagName","readProps","func","Object","assign","end2","propst","pair","string","sep","split1","embed","part2","urlType","readBracketedLink","after","readPlainLink","force","indent","symbol","canStartMarkup","canEndMarkup","bbcode","codeArg","noNesting","b","u","s","h1","h2","h3","tr","td","th","img","specialBlock","inline","point","cancel","readArgList","endTag","isTagChar","key","fallback","result","linkRegex","last","exec","parseLang","alert","TestPageView","setContent","useRouteMatch","pid","page","values","markupLang","rootElement","width","height","dangerouslySetInnerHTML","__html","Home","App","classState","setClassState","setCurrentPageID","path","component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a89f96d1.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nfunction TabButton(props) {\r\n  function selectOption() {\r\n    if (props.selectEvent) props.selectEvent(props.icon);\r\n  }\r\n\r\n  return (\r\n    <button onClick={selectOption} className={props.selected ? \"selected\" : \"\"}>\r\n      <i className={`fa fa-${props.icon}`}></i>\r\n    </button>\r\n  );\r\n}\r\n\r\nexport default TabButton;\r\n","import React, { useEffect, useState } from \"react\";\n\nfunction UserTabButton(props) {\n  const [userImg, setUserImg] = useState(\"\");\n\n  function selectOption() {\n    if (props.selectEvent) props.selectEvent(props.icon);\n  }\n\n  useEffect(() => {\n    if (props.usertoken && props.usertoken !== \"\") {\n      fetch(\"https://newdev.smilebasicsource.com/api/User/me\", {\n        headers: {\n          authorization: `Bearer ${props.usertoken}`,\n        },\n      })\n        .then((res) => res.json())\n        .then((data) =>\n          setUserImg(\n            `https://newdev.smilebasicsource.com/api/file/raw/${data.avatar}?size=64&crop=true`\n          )\n        )\n        .catch((err) => console.error(err));\n    }\n  }, [props.usertoken]);\n\n  return (\n    <button onClick={selectOption} className={props.selected ? \"selected\" : \"\"}>\n      <i\n        className={`fa fa-user`}\n        style={{\n          display: userImg !== \"\" ? \"none\" : \"\",\n        }}\n      ></i>\n      <img\n        src={userImg}\n        alt=\"User Avatar\"\n        style={{\n          display: userImg === \"\" ? \"none\" : \"\",\n        }}\n      />\n    </button>\n  );\n}\n\nexport default UserTabButton;\n","import React, { memo, useState } from \"react\";\r\nimport \"./TabList.css\";\r\nimport TabButton from \"./TabButton.jsx\";\r\nimport UserTabButton from \"./UserTabButton.jsx\";\r\n\r\nfunction TabList(props) {\r\n  const [selectedTab, setSelectedTab] = useState(\"upload\");\r\n  const iconList = [\"upload\", \"list-alt\", \"folder\", \"heart\"];\r\n\r\n  function selectEvent(icon) {\r\n    setSelectedTab(icon);\r\n    if (props.selectEvent) props.selectEvent(icon);\r\n  }\r\n\r\n  return (\r\n    <div className=\"tabList\">\r\n      {iconList.map((i) => (\r\n        <TabButton\r\n          key={i}\r\n          selectEvent={selectEvent}\r\n          icon={i}\r\n          selected={i === selectedTab ? true : false}\r\n        />\r\n      ))}\r\n      <UserTabButton selectEvent={selectEvent} usertoken={props.usertoken} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default memo(TabList);\r\n","import React, { useEffect, useState } from \"react\";\r\n\r\nfunction UploadTab(props) {\r\n  const [uploadedImage, setUploadedImage] = useState(\"\");\r\n\r\n  function handleChange(event) {\r\n    const file = event.target.files[0];\r\n    if (file) setUploadedImage(URL.createObjectURL(file));\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (props.visible === true) {\r\n      props.changeHeader(\"Upload Image\");\r\n    }\r\n  }, [props]);\r\n\r\n  return (\r\n    <div>\r\n      <input\r\n        style={{}}\r\n        onChange={handleChange}\r\n        type=\"file\"\r\n        accept=\"image/*\"\r\n      ></input>\r\n      <img\r\n        src={uploadedImage}\r\n        alt=\"Pasted content\"\r\n        style={{\r\n          maxWidth: \"100%\",\r\n          maxHeight: \"100%\",\r\n          margin: \"auto\",\r\n          display: \"block\",\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UploadTab;\r\n","import React, {useEffect} from \"react\";\r\n\r\nfunction ActivityTab(props) {\r\n  useEffect(() => {\r\n    if (props.visible === true) {\r\n      props.changeHeader(\"Activity\");\r\n    }\r\n  }, [props]);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        margin: \"900px\",\r\n      }}\r\n    >\r\n      HOAISDHIOASDHOASIDHOASIHDoAS\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ActivityTab;\r\n","import React from \"react\";\r\nimport \"./CategoryViewItem.css\";\r\n\r\nfunction CategoryItem(props) {\r\n  return (\r\n    <button onClick={() => props.clickEvent(props.id)}>\r\n      <i className=\"fa fa-folder-open\"></i> {props.name}\r\n    </button>\r\n  );\r\n}\r\n\r\nexport default CategoryItem;\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport \"./CategoryViewItem.css\";\r\n\r\nfunction ContentItem(props) {\r\n  return (\r\n    <Link to={`/sbs-sue-client/#page/${props.id}`} style={{\r\n      textDecoration: \"none\"\r\n    }}>\r\n      <button onClick={() => props.clickEvent(props.id)}>\r\n        <i className=\"fa fa-file\"></i> {props.name}\r\n      </button>\r\n    </Link>\r\n  );\r\n}\r\n\r\nexport default ContentItem;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport CategoryItem from \"./CategoryItem.jsx\";\r\nimport ContentItem from \"./ContentItem.jsx\";\r\n\r\nlet viewCache = {};\r\n\r\nfunction CategoryTab(props) {\r\n  const [categoryID, setCategoryID] = useState(props.id || 0);\r\n  const [categoryMetadata, setCategoryMetadata] = useState({name: \"\", id: 0});\r\n  const [categories, setCategories] = useState([]);\r\n  const [contents, setContents] = useState([]);\r\n  const [loadingContent, setLoadingContent] = useState(false);\r\n\r\n  useEffect(() => {\r\n    let cachedCategoryID = categoryID;\r\n    if (viewCache[cachedCategoryID]) {\r\n      // we need to do safety checks against every single one of these just to make sure that the program\r\n      // doesn't try to overwrite anything when quickly switching between categories, this doesn't 100%\r\n      // work but it's something lol\r\n      if (cachedCategoryID === categoryID)\r\n        if (viewCache[categoryID].category !== {})\r\n          setCategories(viewCache[categoryID].category);\r\n        else setCategories([]);\r\n      if (cachedCategoryID === categoryID)\r\n        if (viewCache[categoryID].content !== {})\r\n          setContents(viewCache[categoryID].content);\r\n        else setContents([]);\r\n      if (cachedCategoryID === categoryID)\r\n        if (viewCache[categoryID].metadata !== {})\r\n          setCategoryMetadata(viewCache[categoryID].metadata);\r\n        else setCategoryMetadata({});\r\n    }\r\n    const params = JSON.stringify({\r\n      parentIds: [categoryID],\r\n      sort: \"name\",\r\n    });\r\n    const url = `https://newdev.smilebasicsource.com/api/Read/chain?requests=content-${params}&content=id,parentid,name&requests=category-${params}&category=id,parentId,name&requests=category.0parentId`;\r\n    setLoadingContent(true);\r\n    fetch(url)\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        // if the category isn't the root id, then extract the metadata about the current category\r\n        let metadata = { name: \"[Root]\", parentId: 0, id: 0 };\r\n        if (categoryID !== 0) {\r\n          metadata = data.category.pop();\r\n        }\r\n        setCategoryMetadata(metadata);\r\n        if (data.category) setCategories(data.category);\r\n        else setCategories([]);\r\n        if (data.content) {\r\n          // This is to filter out all of the garbage user pages at the root directory\r\n          if (categoryID === 0) {\r\n            data.content = data.content.filter((x) => x.name !== \"Userpage\");\r\n          }\r\n          setContents(data.content);\r\n        } else setContents([]);\r\n        setLoadingContent(false);\r\n        viewCache[categoryID] = data;\r\n        viewCache[categoryID].metadata = metadata;\r\n      })\r\n      .catch((err) => console.error(err));\r\n  }, [categoryID]);\r\n\r\n  useEffect(() => {\r\n    if (props.visible === true) {\r\n      props.changeHeader(categoryMetadata.name);\r\n    }\r\n  }, [props, categoryMetadata.name]);\r\n\r\n  function switchCategory(newId) {\r\n    setCategoryID(newId);\r\n  }\r\n\r\n  function switchPage(newId) {\r\n    console.log(newId)\r\n    props.changePage(newId)\r\n  }\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        cursor: loadingContent ? \"wait\" : \"default\"\r\n      }}\r\n    >\r\n        <div\r\n          style={{\r\n            display: categoryMetadata.id !== 0 ? \"block\" : \"none\",\r\n          }}\r\n        >\r\n          <CategoryItem\r\n            key={categoryID}\r\n            name=\"..\"\r\n            id={categoryMetadata.parentId}\r\n            clickEvent={switchCategory}\r\n          />\r\n        </div>\r\n        {categories.map((c) => (\r\n          <CategoryItem\r\n            key={c.id}\r\n            name={c.name}\r\n            id={c.id}\r\n            clickEvent={switchCategory}\r\n          />\r\n        ))}\r\n        {contents.map((c) => (\r\n          <ContentItem key={c.id} id={c.id} name={c.name} clickEvent={switchPage} />\r\n        ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CategoryTab;\r\n","import React, { useState } from \"react\";\r\nimport TabList from \"./TabList.jsx\";\r\nimport UploadTab from \"./UploadTab.jsx\";\r\nimport ActivityTab from \"./ActivityTab.jsx\";\r\nimport CategoryTab from \"./CategoryTab.jsx\";\r\nimport \"./Sidebar.css\";\r\n\r\nfunction Sidebar(props) {\r\n  const [tab, setTab] = useState(\"upload\");\r\n  const [headerDisplay, setHeaderDisplay] = useState(\"Loading...\")\r\n\r\n  function selectEvent(icon) {\r\n    setTab(icon);\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"sidebar\"\r\n    >\r\n      <header>\r\n        {headerDisplay}\r\n      </header>\r\n      <div\r\n        style={{\r\n          flex: \"1\",\r\n          overflow: \"auto\",\r\n        }}\r\n      >\r\n        <div className={tab !== \"upload\" ? \"hiddenTab\" : \"\"}>\r\n          <UploadTab changeHeader={setHeaderDisplay} visible={tab !== \"upload\" ? false : true}/>\r\n        </div>\r\n        <div className={tab !== \"list-alt\" ? \"hiddenTab\" : \"\"}>\r\n          <ActivityTab changeHeader={setHeaderDisplay} visible={tab !== \"list-alt\" ? false : true} />\r\n        </div>\r\n        <div className={tab !== \"folder\" ? \"hiddenTab\" : \"\"}>\r\n          <CategoryTab changePage={props.changePage} changeHeader={setHeaderDisplay} visible={tab !== \"folder\" ? false : true}/>\r\n        </div>\r\n      </div>\r\n      <div style={{\r\n      }}>\r\n        <TabList usertoken={props.usertoken} selectEvent={selectEvent} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Sidebar;\r\n","/* eslint-disable no-undef */\n/* eslint-disable no-restricted-globals */\n// TODO:\n// the system for handling resizes (for autoscroll) is a big mess\n// maybe try creating a custom event that gets triggered whenever\n// an element's height will be changed (when clicking an image, activating a youtube player, etc.)\n// and listen for it on the root element externally\n// see: document.createEvent\n\nvar Parse = {\n\tlang:{}\n}\n\n// parser options\n// this can be easily changed\n// to control the output\n\n// most functions should return an object containing:\n//   .node or .nodes - the node(s) to insert\n//   .branch - (optional if .node was specified) which node to insert children into\n//   .block - `true` if the element is display: block or similar.\n\n// most functions take input in the form of either\n// (args) (or (args, contents) for things where the contents are plain text)\n// (code blocks, [img], etc.)\n// the unnamed argument uses a key of \"\"\n// args without a value are set to true\n// for example, `[tag=test key=value option]` would pass\n// {\"\":\"test\", key:\"value\", option:true}\n;(function() {\n\tfunction create(x) {\n\t\treturn document.createElement(x)\n\t}\n\tfunction createText(x) {\n\t\treturn document.createTextNode(x)\n\t}\n\tfunction creator(tag) {\n\t\treturn function() {\n\t\t\treturn {node:create(tag)}\n\t\t}\n\t}\n\tfunction newEvent(name) {\n\t\tvar event = document.createEvent(\"Event\");\n\t\tevent.initEvent(name, true, true);\n\t\treturn event;\n\t}\n\tfunction getYoutube(id, callback) {\n\t\tvar x = new XMLHttpRequest\n\t\tx.open(\"GET\", \"https://www.googleapis.com/youtube/v3/videos?part=snippet&id=\"+id+\"&key=AIzaSyBKka_xlF5pV4SMKLtQGIhOgyQsjF7UI-U\");\n\t\tx.onload = function() {\n\t\t\tif (x.status != 200)\n\t\t\t\treturn\n\t\t\ttry {\n\t\t\t\tvar json = JSON.parse(x.responseText)\n\t\t\t\tvar video = json.items[0]\n\t\t\t\tcallback(video);\n\t\t\t} catch(e){}\n\t\t}\n\t\tx.send();\n\t}\n\tfunction defaultProtocol() {\n\t\tif (window.location.protocol == 'http:')\n\t\t\treturn 'http:'\n\t\telse\n\t\t\treturn 'https:'\n\t}\n\tfunction getYoutubeID(url) {\n\t\tvar match = url.match(/(?:https?:\\/\\/)?(?:www\\.)?youtu\\.?be(?:\\.com)?\\/?.*(?:watch|embed)?(?:.*v=|v\\/|\\/)([\\w\\-_]+)\\&?/)\n\t\tif (match)\n\t\t\treturn match[1]\n\t\treturn null\n\t}\n\t// returns [protocol, rest of url] or [null, url]\n\tfunction urlProtocol(url) {\n\t\tvar match = url.match(/^([-\\w]+:)([^]*)$/)\n\t\tif (match)\n\t\t\treturn [match[1].toLowerCase(), match[2]]\n\t\treturn [null, url]\n\t}\n\n\t// so normally our path structure will look like\n\t// url#path?query#fragment\n\t// with #s in the path and query escaped with %\n\t// however, some browsers escape duplicate #s automatically, so this has to be dealt with somehow\n\t// I'm not sure of a good way which still allows # to be used in the path+query, though\n\t// may need to use a different character...\n\tfunction getPath() {\n\t\tvar hash = decodeURIComponent(location.hash.substr(1))\n\t\treturn hash.split(\"#\")\n\t}\n\t\n\tParse.options = {\n\t\tappend: function (parent, child) {\n\t\t\tparent = parent.branch || parent.node\n\n\t\t\tif (child.nodes)\n\t\t\t\tchild.nodes.forEach(function(x){\n\t\t\t\t\tparent.appendChild(x)\n\t\t\t\t})\n\t\t\telse\n\t\t\t\tparent.appendChild(child.node)\n\t\t},\n\t\t\n\t\t//========================\n\t\t// nodes without children:\n\t\ttext: function(text) {\n\t\t\treturn {node: createText(text)}\n\t\t},\n\t\tlineBreak: creator('br'),\n\t\tline: creator('hr'),\n\t\t// used for displaying invalid markup\n\t\t// reason is currently unused\n\t\tinvalid: function(text, reason) {\n\t\t\tvar node = create('span')\n\t\t\tnode.className = 'invalid'\n\t\t\tnode.title = reason\n\t\t\tnode.textContent = text\n\t\t\treturn {node:node}\n\t\t},\n\t\t// code block\n\t\tcode: function(args, contents) {\n\t\t\tvar language = args[\"\"]\n\t\t\tvar node = create('pre')\n\t\t\tnode.setAttribute('data-lang', language)\n\t\t\t// node.innerHTML = highlightSB(contents, language)\n\t\t\treturn {block:true, node:node}\n\t\t},\n\t\t// inline code\n\t\ticode: function(args, contents) {\n\t\t\tvar node = create('code')\n\t\t\tnode.textContent = contents\n\t\t\treturn {node:node, block:false}\n\t\t},\n\t\taudio: function(args) {\n\t\t\tvar node = create('audio')\n\t\t\tnode.setAttribute('controls', \"\")\n\t\t\tnode.setAttribute('src', args[\"\"])\n\t\t\treturn {block:true, node:node}\n\t\t},\n\t\tvideo: function(args) {\n\t\t\tvar url = args[\"\"]\n\t\t\tvar node = create('video')\n\t\t\tnode.setAttribute('controls', \"\")\n\t\t\tnode.setAttribute('src', url)\n\t\t\treturn {block:true, node:node}\n\t\t},\n\t\tyoutube: function(args, preview) {\n\t\t\tvar url = args[\"\"]\n\t\t\tvar protocol = defaultProtocol()\n\t\t\tvar match = getYoutubeID(url)\n\t\t\tvar link = create('a')\n\t\t\tvar div = create('div')\n\t\t\tdiv.className = \"youtube\"\n\t\t\tdiv.appendChild(link)\n\t\t\tlink.href = url\n\t\t\t\n\t\t\tif (match) {\n\t\t\t\tlink.style.backgroundImage = 'url(\"'+protocol+\"//i.ytimg.com/vi/\"+match+\"/mqdefault.jpg\"+'\")'\n\t\t\t\tvar time = url.match(/[&?](?:t|start)=(\\w+)/);\n\t\t\t\tvar end = url.match(/[&?](?:end)=(\\w+)/);\n\t\t\t\tvar loop = url.match(/[&?]loop(=|&|$)/);\n\t\t\t\tif (!preview)\n\t\t\t\t\tgetYoutube(match, function(data) {\n\t\t\t\t\t\tvar title = create('div')\n\t\t\t\t\t\ttitle.className = 'pre videoTitle'\n\t\t\t\t\t\ttitle.textContent = data.snippet.title\n\t\t\t\t\t\tlink.appendChild(title)\n\t\t\t\t\t\tlink.appendChild(create('br'));\n\t\t\t\t\t\ttitle = create('div')\n\t\t\t\t\t\ttitle.className = 'pre videoAuthor'\n\t\t\t\t\t\ttitle.textContent = data.snippet.channelTitle\n\t\t\t\t\t\tlink.appendChild(title)\n\t\t\t\t\t})\n\t\t\t\tvar ifc = create('span')\n\t\t\t\tlink.appendChild(ifc)\n\t\t\t\tlink.onclick = function(e) {\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\tdiv.dispatchEvent(newEvent(\"beforeSizeChange\"));\n\t\t\t\t\tvar iframe = create('iframe')\n\t\t\t\t\tvar src = \"https://www.youtube-nocookie.com/embed/\"+match+\"?autoplay=1\";\n\t\t\t\t\tif (time)\n\t\t\t\t\t\tsrc += \"&start=\"+time[1];\n\t\t\t\t\tif (end)\n\t\t\t\t\t\tsrc += \"&end=\"+end[1];\n\t\t\t\t\tif (loop)\n\t\t\t\t\t\tsrc += \"&loop=1&playlist=\"+match;\n\t\t\t\t\tiframe.src = src;\n\t\t\t\t\tifc.appendChild(iframe)\n\t\t\t\t\tdiv.className = \"youtube playingYoutube\"\n\t\t\t\t\tdiv.dispatchEvent(newEvent(\"afterSizeChange\"));\n\t\t\t\t}\n\t\t\t\tvar stop = create('button')\n\t\t\t\tstop.textContent = \"x\"\n\t\t\t\tstop.onclick = function(e) {\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\tdiv.dispatchEvent(newEvent(\"beforeSizeChange\"));\n\t\t\t\t\tifc.innerHTML = \"\"\n\t\t\t\t\tdiv.className = \"youtube\"\n\t\t\t\t\tdiv.dispatchEvent(newEvent(\"afterSizeChange\"));\n\t\t\t\t}\n\t\t\t\tdiv.appendChild(stop)\n\t\t\t}\n\t\t\treturn {block:true, node:div}\n\t\t},\n\t\tbg: function(opt) {\n\t\t\tvar node=document.createElement(\"span\")\n\t\t\tvar color = opt[\"\"]\n\t\t\tif (color) {\n\t\t\t\tnode.setAttribute(\"data-bgcolor\", color)\n\t\t\t}\n\t\t\treturn {node:node}\n\t\t},\n\t\t\n\t\t//=====================\n\t\t// nodes with children\n\t\troot: function() {\n\t\t\tvar node = document.createDocumentFragment()\n\t\t\treturn {block:true, node:node}\n\t\t},\n\t\tbold: creator('b'),\n\t\titalic: creator('i'),\n\t\tunderline: creator('u'),\n\t\tstrikethrough: creator('s'),\n\t\theading: function(level) { // input: 1, 2, or 3\n\t\t\t// output: h2-h4\n\t\t\treturn {block:true, node:create('h'+(level+1))}\n\t\t},\n\t\t\n\t\tquote: function(args) {\n\t\t\t// <blockquote><cite> arg </cite><br> ... </blockquote>\n\t\t\tvar name = args[\"\"]\n\t\t\tvar node = create('blockquote')\n\t\t\tif (name) {\n\t\t\t\tvar cite = create('cite')\n\t\t\t\tcite.textContent = name\n\t\t\t\tnode.appendChild(cite)\n\t\t\t\tnode.appendChild(create('br'))\n\t\t\t}\n\t\t\treturn {block:true, node:node}\n\t\t},\n\t\tlist: function(args) {\n\t\t\t// <ul> ... </ul>\n\t\t\tif (args[\"\"]!=undefined) {\n\t\t\t\tvar list = create('ol')\n\t\t\t\tlist.style.listStyleType = args[\"\"]\n\t\t\t} else\n\t\t\t\tlist = create('ul')\n\t\t\treturn {block:true, node:list}\n\t\t},\n\t\titem: function(index) {\n\t\t\treturn {block:true, node:create('li')}\n\t\t},\n\t\t//creator('li'), // (list item)\n\t\t\n\t\tlink: function(args) {\n\t\t\t// <a href= url> ... </a>\n\t\t\tvar url = args[\"\"]\n\t\t\t// important, do not remove, prevents script injection\n\t\t\tif (/^ *javascript:/i.test(url))\n\t\t\t\turl = \"\"\n\t\t\t\n\t\t\tvar node = create('a')\n\t\t\t\n\t\t\tvar protocol = urlProtocol(url)\n\t\t\tnode.setAttribute('target', \"_blank\")\n\t\t\tif (protocol[0] == \"sbs:\") {\n\t\t\t\t// put your custom local url handling code here\n\t\t\t\turl = \"#\"+protocol[1]\n\t\t\t\tnode.removeAttribute('target')\n\t\t\t} else if (!protocol[0]) {\n\t\t\t\tif (url[0] == \"#\") {\n\t\t\t\t\t// put your fragment link handling code here\n\t\t\t\t\tvar hash1 = getPath()\n\t\t\t\t\tvar name = url.substr(1)\n\t\t\t\t\thash = \"#\"+hash1[0]+\"#\"+name\n\t\t\t\t\turl = hash\n\t\t\t\t\tnode.onclick = function(e) {\n\t\t\t\t\t\tvar hash2 = getPath()\n\t\t\t\t\t\tif (hash1[0]==hash2[0] && hash2[1]==name) {\n\t\t\t\t\t\t\tvar n = document.getElementsByName(\"_anchor_\"+name)\n\t\t\t\t\t\t\tif (n[0])\n\t\t\t\t\t\t\t\tn[0].scrollIntoView()\n\t\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twindow.location.hash = hash\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// urls without protocol get https:// or http:// added\n\t\t\t\t\turl = defaultProtocol()+\"//\"+url\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\tnode.setAttribute('href', url)\n\t\t\treturn {node:node}\n\t\t},\n\t\t\n\t\ttable: function(opts) {\n\t\t\t// <div class=\"tableContainer\"><table> ... </table></div>\n\t\t\tvar container = create('div')\n\t\t\tcontainer.className = \"tableContainer\"\n\t\t\tvar node = create('table')\n\t\t\tcontainer.appendChild(node)\n\t\t\treturn {\n\t\t\t\tblock: true,\n\t\t\t\tnode: container,\n\t\t\t\tbranch: node\n\t\t\t}\n\t\t},\n\t\t\n\t\trow: creator('tr'),\n\t\t\n\t\tcell: function (opt) {\n\t\t\t// <td> ... </td> etc.\n\t\t\tvar node = opt.h ?\n\t\t\t\t create('th') :\n\t\t\t\t create('td')\n\t\t\tif (opt.rs)\n\t\t\t\tnode.rowSpan = opt.rs\n\t\t\tif (opt.cs)\n\t\t\t\tnode.colSpan = opt.cs\n\t\t\tif (opt.c) {\n\t\t\t\tif (opt.c[0] == \"#\")\n\t\t\t\t\tnode.style.backgroundColor = opt.c\n\t\t\t\tnode.setAttribute(\"data-bgcolor\", opt.c)\n\t\t\t}\n\t\t\tif (opt.a) {\n\t\t\t\tnode.style.textAlign = opt.a\n\t\t\t}\n\t\t\tnode.className = \"cell\"\n\t\t\treturn {node:node}\n\t\t},\n\t\t\n\t\timage: function(args) {\n\t\t\t// <img src= arg tabindex=\"-1\">\n\t\t\tvar url = args[\"\"]\n\t\t\tvar node = create('img')\n\t\t\tnode.setAttribute('src', url)\n\t\t\tnode.setAttribute('tabindex', \"-1\")\n\t\t\t/*node.onload = function() {\n\t\t\t  if (window.scrollToAuto)\n\t\t\t  scrollToAuto()\n\t\t\t  }*/\n\t\t\treturn {node:node, block:true}\n\t\t},\n\t\t\n\t\t// parser error message\n\t\terror: function(e, stack) {\n\t\t\t// <div class=\"error\">Error while parsing:<pre> stack trace </pre>Please report this</div>\n\t\t\tvar node = create('div')\n\t\t\tnode.className = \"error\"\n\t\t\tnode.appendChild(createText(\"Markup parsing error: \"))\n\t\t\tvar err = create('code')\n\t\t\terr.textContent = e\n\t\t\tnode.appendChild(err)\n\t\t\tnode.appendChild(createText(\"\\nPlease report this!\"))\n\t\t\tif (stack) {\n\t\t\t\tvar pre = create('pre')\n\t\t\t\tpre.textContent = stack\n\t\t\t\tnode.appendChild(pre)\n\t\t\t}\n\t\t\treturn {node:node, block:true}\n\t\t},\n\t\t\n\t\talign: function(args) {\n\t\t\tvar node = create('div')\n\t\t\tvar arg = args[\"\"]\n\t\t\tif (arg == 'left' || arg == 'right' || arg == 'center')\n\t\t\t\tnode.style.textAlign = arg\n\t\t\treturn {node:node, block:true}\n\t\t},\n\t\tsuperscript: creator('sup'),\n\t\tsubscript: creator('sub'),\n\t\tanchor: function(args) {\n\t\t\tvar name = args[\"\"]\n\t\t\tvar node = create('a')\n\t\t\t// put your anchor name handler here\n\t\t\t// I prefix the names to avoid collision with node ids\n\t\t\t// which use the same namespace as name\n\t\t\tnode.name = \"_anchor_\"+name\n\t\t\treturn {node:node, block:true}\n\t\t},\n\t\tspoiler: function(args) {\n\t\t\t// <button> arg </button><div class=\"spoiler\"> ... </div>\n\t\t\t// I'd use <summary>/<details> but it's not widely supported\n\t\t\t// and impossible to style with css\n\t\t\t// this probably needs some aria attribute or whatever\n\t\t\tvar button = create('button')\n\t\t\tbutton.onclick = function() {\n\t\t\t\tif (this.getAttribute('data-show') == null)\n\t\t\t\t\tthis.setAttribute('data-show',\"\")\n\t\t\t\telse\n\t\t\t\t\tthis.removeAttribute('data-show')\n\t\t\t}\n\t\t\tbutton.className = 'spoilerButton'\n\t\t\tvar name = args[\"\"]\n\t\t\tif (name == true)\n\t\t\t\tname = \"spoiler\"\n\t\t\tbutton.textContent = name\n\t\t\t\n\t\t\tvar box = create('div')\n\t\t\tbox.className = \"spoiler\"\n\t\t\t\n\t\t\treturn {\n\t\t\t\tblock: true,\n\t\t\t\tnodes: [button, box],\n\t\t\t\tbranch: box\n\t\t\t}\n\t\t}\n\t}\n})()\n\n;(function(){\n\t/***********\n\t ** STATE **\n    ***********/\n\tvar c,i,cache = null,code\n\tvar editorCache = {video:{},audio:{},youtube:{}}\n\tvar skipNextLineBreak\n\tvar textBuffer\n\tvar curr, output\n\tvar stack\n\tvar startOfLine\n\tvar leadingSpaces\n\tvar blocks\n\tfunction scan(){}\n\n\tfunction errorHandle(func) {\n\t\ttry {\n\t\t\tfunc()\n\t\t} catch (e) {\n\t\t\t// todo: close all blocks and add error message\n\t\t}\n\t}\n\t\n\tfunction init(scanFunc, myBlocks, text) {\n\t\tscan = scanFunc\n\t\tcode = text\n\t\tif (cache)\n\t\t\tfor (type in cache)\n\t\t\t\tfor (arg in cache[type])\n\t\t\t\t\tcache[type][arg].forEach(function(x){\n\t\t\t\t\t\tx.used = false\n\t\t\t\t\t})\n\t\tblocks = myBlocks\n\t\tleadingSpaces = 0\n\t\tstartOfLine = true\n\t\tskipNextLineBreak = false\n\t\ttextBuffer = \"\"\n\t\toutput = curr = options.root()\n\t\tstack = [{node:curr, type:'root'}]\n\t\tstack.top = function() {\n\t\t\treturn stack[stack.length-1]\n\t\t}\n\t\trestore(0)\n\t}\n\t// move to pos\n\tfunction restore(pos) {\n\t\ti = pos-1\n\t\tscan()\n\t}\n\n\t//try to read a char\n\tfunction eatChar(chr) {\n\t\tif (c == chr) {\n\t\t\tscan()\n\t\t\treturn true\n\t\t}\n\t}\n\n\tfunction matchNext(str) {\n\t\treturn code.substr(i, str.length) == str\n\t}\n\t\n\t// read a url\n\t// if `allow` is true, url is only ended by end of file or ]] or ][ (TODO)\n\tfunction readUrl(allow) {\n\t\tvar start = i\n\t\tif (allow)\n\t\t\twhile (c && c!=\"]\" && c!=\"[\")\n\t\t\t\tscan()\n\t\telse\n\t\t\twhile (isUrlChar(c))\n\t\t\t\tscan()\n\t\treturn code.substring(start, i)\n\t}\n\n\t\n\t// ew regex\n\tfunction isUrlChar(c) {\n\t\t// removed ) because interferes with stuff too much\n\t\t// other problems common are\n\t\t// - period, comma, etc. after url\n\t\treturn c && (/[-\\w\\$\\.+!*'(,;/\\?:@=&#%]/).test(c)\n\t}\n\t/***********\n    ** stack **\n    ***********/\n\tfunction stackContains(type) {\n\t\tfor (var i=0; i<stack.length; i++) {\n\t\t\tif (stack[i].type == type) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\t\treturn false\n\t}\n\tfunction top_is(type) {\n\t\tvar top = stack.top()\n\t\treturn top && top.type == type\n\t}\n\t\n\t/****************\n    ** outputting **\n    ****************/\n\tfunction endBlock() {\n\t\tflushText()\n\t\tvar item = stack.pop()\n\t\tif (item.node && item.node.block)\n\t\t\tskipNextLineBreak = true\n\n\t\tif (stack.length) {\n\t\t\tvar i=stack.length-1\n\t\t\t// this skips {} fake nodes\n\t\t\t// it will always find at least the root <div> element I hope\n\t\t\twhile (!stack[i].node){\n\t\t\t\ti--\n\t\t\t}\n\t\t\tcurr = stack[i].node\n\t\t} else {\n\t\t\tcurr = null\n\t\t}\n\t}\n\t\n\t// add simple block with no children\n\tfunction addBlock(node) {\n\t\tflushText()\n\t\toptions.append(curr, node)\n\t}\n\n\t// output contents of text buffer\n\tfunction flushText() {\n\t\tif (textBuffer) {\n\t\t\toptions.append(curr, options.text(textBuffer))\n\t\t\ttextBuffer = \"\"\n\t\t}\n\t}\n\n\t// add linebreak to output\n\t// todo: skipping linebreaks should skip / *\\n? */ (spaces before/after!)\n\t// so like [h1]test[/h1] [h2]test[/h2]\n\t// no extra linebreak there\n\tfunction addLineBreak() {\n\t\tif (skipNextLineBreak) {\n\t\t\tskipNextLineBreak = false\n\t\t} else {\n\t\t\tflushText()\n\t\t\taddBlock(options.lineBreak())\n\t\t}\n\t}\n\n\t// add text to output (buffered)\n\tfunction addText(text) {\n\t\tif (text) {\n\t\t\ttextBuffer += text\n\t\t\tskipNextLineBreak = false\n\t\t}\n\t}\n\t\n\t// call at end of parsing to flush output\n\tfunction endAll() {\n\t\tflushText()\n\t\twhile (stack.length)\n\t\t\tendBlock()\n\t}\n\t\n\t/*****************\n    ** cache stuff **\n    *****************/\n\tfunction findUnusedCached(cache, type, arg) {\n\t\tvar list = cache[type][arg]\n\t\tif (!list)\n\t\t\treturn null\n\t\tfor (var i=0;i<list.length;i++) {\n\t\t\tif (!list[i].used)\n\t\t\t\treturn list[i]\n\t\t}\n\t\treturn null\n\t}\n\n\tfunction startBlock(type, data, arg) {\n\t\tdata.type = type\n\t\tif (type) {\n\t\t\t\n\t\t\tvar node = tryGetCached(cache, type, arg && arg[\"\"], function() {\n\t\t\t\treturn blocks[type](arg)\n\t\t\t})\n\t\t\tdata.node = node\n\t\t\tif (node.block)\n\t\t\t\tskipNextLineBreak = true\n\t\t\t\n\t\t\tflushText()\n\t\t\toptions.append(curr, node)\n\t\t\tcurr = node\n\t\t}\n\t\tstack.push(data)\n\t\treturn data\n\t}\n\t// check for /\\b(http://|https://|sbs:)/ basically\n\tfunction isUrlStart() {\n\t\tif (code[i-1] && /\\w/.test(code[i-1]))\n\t\t\treturn false\n\t\treturn matchNext(\"http://\") || matchNext(\"https://\") || matchNext(\"sbs:\")\n\t}\n\t\n\t// try to get a node from cache.\n\t// will get nodes where `type` and `arg` matches\n\t// if not found, returns make(), and adds to cache\n\tfunction tryGetCached(cache, type, arg, make) {\n\t\tvar node\n\t\tif (cache && type && cache[type]) {\n\t\t\tvar item = findUnusedCached(cache, type, arg)\n\t\t\tif (item) {\n\t\t\t\titem.used = true\n\t\t\t\tnode = item.node\n\t\t\t}\n\t\t}\n\t\tif (!node && type) {\n\t\t\tnode = make()\n\t\t\tif (cache && cache[type]) {\n\t\t\t\tif (!cache[type][arg])\n\t\t\t\t\tcache[type][arg] = []\n\t\t\t\tcache[type][arg].push({node:node, used:true})\n\t\t\t}\n\t\t}\n\t\treturn node\n\t}\n\n\tvar options = Parse.options\n\t\n\tParse.lang['12y'] = function(codeInput, preview) {\n\t\t// so what happens here is\n\t\t// when a video needs to be generated\n\t\t// first, check the cache. if it exists there, insert it\n\t\t// (remember that a node can only exist in one place in the DOM though)\n\t\t// now, if the video needs to be created, and preview mode is enabled,\n\t\t// a place holder is generated (and not stored in the cache)\n\t\t// if preview is disabled (and cache is passed), the video is generated\n\t\t// and stored in the cache, to be reused later\n\t\t\n\t\t// in the editor, this should be called normally with preview mode enabled\n\t\t// then maybe after a delay of no typing, call it with preview off,\n\t\t// to generate any new videos\n\t\t// or don't use preview at all! maybe it's fine!\n\n\t\tinit(function() {\n\t\t\tif (c == \"\\n\" || !c)\n\t\t\t\tlineStart()\n\t\t\telse if (c != \" \")\n\t\t\t\tstartOfLine = false\n\t\t\telse if (startOfLine)\n\t\t\t\tleadingSpaces++\n\t\t\ti++\n\t\t\tc = code.charAt(i)\n\t\t}, options, codeInput)\n\t\t\n\t\tvar tags = {\n\t\t\tspoiler: \"spoiler\",\n\t\t\talign: \"align\",\n\t\t\tsub: \"subscript\",\n\t\t\tsup: \"superscript\",\n\t\t\tanchor: \"anchor\",\n\t\t\tbg: \"bg\"\n\t\t}\n\t\t\n\t\twhile (c) {\n\t\t\tif (eatChar(\"\\n\")) {\n\t\t\t\tendLine()\n\t\t\t\t//==========\n\t\t\t\t// \\ escape\n\t\t\t} else if (eatChar(\"\\\\\")) {\n\t\t\t\tif (c == \"\\n\") {\n\t\t\t\t\tflushText()\n\t\t\t\t\taddBlock(options.lineBreak())\n\t\t\t\t} else\n\t\t\t\t\taddText(c)\n\t\t\t\tscan()\n\t\t\t\t//===============\n\t\t\t\t// { group start (why did I call these \"groups\"?)\n\t\t\t} else if (c == \"{\") {\n\t\t\t\treadEnv()\n\t\t\t\t//=============\n\t\t\t\t// } group end\n\t\t\t} else if (eatChar(\"}\")) {\n\t\t\t\tif (stackContains(null)) {\n\t\t\t\t\tcloseAll(false)\n\t\t\t\t} else {\n\t\t\t\t\taddText(\"}\")\n\t\t\t\t}\n\t\t\t\t//================\n\t\t\t\t// * heading/bold\n\t\t\t} else if (c == \"*\") {\n\t\t\t\tif (startOfLine && (code[i+1] == \"*\" || code[i+1] == \" \")) {\n\t\t\t\t\tvar headingLevel = 0\n\t\t\t\t\twhile (eatChar(\"*\"))\n\t\t\t\t\t\theadingLevel++\n\t\t\t\t\tif (headingLevel > 3)\n\t\t\t\t\t\theadingLevel = 3\n\t\t\t\t\t\n\t\t\t\t\tif (eatChar(\" \"))\n\t\t\t\t\t\tstartBlock('heading', {}, headingLevel)\n\t\t\t\t\telse\n\t\t\t\t\t\taddMulti('*', headingLevel)\n\t\t\t\t} else {\n\t\t\t\t\tdoMarkup('bold', options.bold)\n\t\t\t\t}\n\t\t\t} else if (c == \"/\") {\n\t\t\t\tdoMarkup('italic', options.italic)\n\t\t\t} else if (c == \"_\") {\n\t\t\t\tdoMarkup('underline', options.underline)\n\t\t\t} else if (c == \"~\") {\n\t\t\t\tdoMarkup('strikethrough', options.strikethrough)\n\t\t\t\t//============\n\t\t\t\t// >... quote\n\t\t\t} else if (startOfLine && eatChar(\">\")) {\n\t\t\t\t// todo: maybe >text should be a quote without author... \n\t\t\t\t// need to add a way to add information to quotes:\n\t\t\t\t// - user ID\n\t\t\t\t// - post ID\n\t\t\t\tstart = i\n\t\t\t\twhile (eatChar(\" \"))\n\t\t\t\t\t\n\t\t\t\twhile (c && !char_in(c, \" \\n{:\"))\n\t\t\t\t\tscan()\n\t\t\t\tvar name = code.substring(start, i).trim()\n\t\t\t\teatChar(\":\")\n\t\t\t\twhile (eatChar(\" \"))\n\t\t\t\t\t\n\t\t\t\tstartBlock('quote', {}, {\"\":name})\n\t\t\t\t//==============\n\t\t\t\t// -... list/hr\n\t\t\t} else if (startOfLine && eatChar(\"-\")) {\n\t\t\t\ttextBuffer = \"\" //hack:\n\t\t\t\t//----------\n\t\t\t\t// --... hr\n\t\t\t\tif (eatChar(\"-\")) {\n\t\t\t\t\tvar count = 2\n\t\t\t\t\twhile (eatChar(\"-\"))\n\t\t\t\t\t\tcount++\n\t\t\t\t\t//-------------\n\t\t\t\t\t// ---<EOL> hr\n\t\t\t\t\tif (c == \"\\n\" || !c) { //this is kind of bad\n\t\t\t\t\t\taddBlock(options.line())\n\t\t\t\t\t\tskipNextLineBreak = true //hack\n\t\t\t\t\t\t//----------\n\t\t\t\t\t\t// ---... normal text\n\t\t\t\t\t} else {\n\t\t\t\t\t\taddMulti(\"-\", count)\n\t\t\t\t\t}\n\t\t\t\t\t//------------\n\t\t\t\t\t// - ... list\n\t\t\t\t} else if (eatChar(\" \")) {\n\t\t\t\t\tstartBlock('list', {level:leadingSpaces}, {})\n\t\t\t\t\tstartBlock('item', {level:leadingSpaces})\n\t\t\t\t\t//---------------\n\t\t\t\t\t// - normal char\n\t\t\t\t} else\n\t\t\t\t\taddText(\"-\")\n\t\t\t\t//==========================\n\t\t\t\t// ] end link if inside one\n\t\t\t} else if (c == \"]\" && stack.top().inBrackets){ //this might break if it assumes .top() exists. needs more testing\n\t\t\t\tscan()\n\t\t\t\tif (stack.top().big) {\n\t\t\t\t\tif (eatChar(\"]\"))\n\t\t\t\t\t\tendBlock()\n\t\t\t\t\telse\n\t\t\t\t\t\taddText(\"]\")\n\t\t\t\t} else\n\t\t\t\t\tendBlock()\n\t\t\t\t//============\n\t\t\t\t// |... table\n\t\t\t} else if (c == \"|\") {\n\t\t\t\tvar top = stack.top()\n\t\t\t\t// continuation\n\t\t\t\tif (top.type == 'cell') {\n\t\t\t\t\tscan()\n\t\t\t\t\tvar row = top.row\n\t\t\t\t\tvar table = top.row.table\n\t\t\t\t\tvar eaten = eatChar(\"\\n\")\n\t\t\t\t\t//--------------\n\t\t\t\t\t// | | next row\n\t\t\t\t\tif (eaten && eatChar(\"|\")) {\n\t\t\t\t\t\t// number of cells in first row\n\t\t\t\t\t\t// determines number of columns in table\n\t\t\t\t\t\tif (table.columns == null)\n\t\t\t\t\t\t\ttable.columns = row.cells\n\t\t\t\t\t\t// end blocks\n\t\t\t\t\t\tendBlock() //cell\n\t\t\t\t\t\tif (top_is('row')) //always\n\t\t\t\t\t\t\tendBlock()\n\t\t\t\t\t\t// start row\n\t\t\t\t\t\t// calculate number of cells in row which will be\n\t\t\t\t\t\t// already filled due to previous row-spanning cells\n\t\t\t\t\t\tvar cells = 0\n\t\t\t\t\t\ttable.rowspans = table.rowspans.map(function(span){\n\t\t\t\t\t\t\tcells++\n\t\t\t\t\t\t\treturn span-1\n\t\t\t\t\t\t}).filter(function(span){return span > 0})\n\t\t\t\t\t\tvar row = startBlock('row', {table:table, cells:cells})\n\t\t\t\t\t\trow.header = eatChar(\"*\")\n\t\t\t\t\t\t// start cell\n\t\t\t\t\t\tstartCell(row)\n\t\t\t\t\t\t//--------------------------\n\t\t\t\t\t\t// | next cell or table end\n\t\t\t\t\t} else {\n\t\t\t\t\t\trow.cells++\n\t\t\t\t\t\ttextBuffer = textBuffer.replace(/ *$/,\"\") //strip trailing spaces (TODO: allow \\<space>)\n\t\t\t\t\t\t// end of table\n\t\t\t\t\t\t// table ends when number of cells in current row = number of cells in first row\n\t\t\t\t\t\t// single-row tables are not easily possible ..\n\t\t\t\t\t\t// TODO: fix single row tables\n\t\t\t\t\t\tif (table.columns != null && row.cells > table.columns) {\n\t\t\t\t\t\t\tendBlock() //end cell\n\t\t\t\t\t\t\tif (top_is('row')) //always\n\t\t\t\t\t\t\t\tendBlock() //row\n\t\t\t\t\t\t\tif (top_is('table')) //always\n\t\t\t\t\t\t\t\tendBlock() //table\n\t\t\t\t\t\t\tif (eaten)\n\t\t\t\t\t\t\t\taddLineBreak()\n\t\t\t\t\t\t} else { // next cell\n\t\t\t\t\t\t\tendBlock() //cell\n\t\t\t\t\t\t\tstartCell(row)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// start of new table (must be at beginning of line)\n\t\t\t\t} else if (startOfLine) {\n\t\t\t\t\tscan()\n\t\t\t\t\ttable = startBlock('table', {\n\t\t\t\t\t\tcolumns: null,\n\t\t\t\t\t\trowspans: []\n\t\t\t\t\t}, {})\n\t\t\t\t\trow = startBlock('row', {\n\t\t\t\t\t\ttable: table,\n\t\t\t\t\t\tcells: 0\n\t\t\t\t\t})\n\t\t\t\t\trow.header = eatChar(\"*\")\n\t\t\t\t\tstartCell(row)\n\t\t\t\t} else {\n\t\t\t\t\tscan()\n\t\t\t\t\taddText(\"|\")\n\t\t\t\t}\n\t\t\t\t//===========\n\t\t\t\t// `... code\n\t\t\t} else if (eatChar(\"`\")) {\n\t\t\t\t//---------------\n\t\t\t\t// ``...\n\t\t\t\tif (eatChar(\"`\")) {\n\t\t\t\t\t//----------------\n\t\t\t\t\t// ``` code block\n\t\t\t\t\tif (eatChar(\"`\")) {\n\t\t\t\t\t\t// read lang name\n\t\t\t\t\t\tlet start = i\n\t\t\t\t\t\twhile (c && c!=\"\\n\" && c!=\"`\")\n\t\t\t\t\t\t\tscan()\n\t\t\t\t\t\t//todo: protect against ```why won't this work``` ?\n\t\t\t\t\t\tvar language = code.substring(start, i).trim().toLowerCase()\n\t\t\t\t\t\tvar eaten = eatChar(\"\\n\")\n\t\t\t\t\t\tstart = i\n\t\t\t\t\t\ti = code.indexOf(\"```\", i)\n\t\t\t\t\t\taddBlock(options.code(\n\t\t\t\t\t\t\t{\"\": language},\n\t\t\t\t\t\t\tcode.substring(start, i!=-1 ? i : code.length)\n\t\t\t\t\t\t))\n\t\t\t\t\t\tskipNextLineBreak = eaten\n\t\t\t\t\t\tif (i != -1) {\n\t\t\t\t\t\t\trestore(i + 3)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trestore(code.length)\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//------------\n\t\t\t\t\t\t// `` invalid\n\t\t\t\t\t} else {\n\t\t\t\t\t\taddText(\"``\")\n\t\t\t\t\t}\n\t\t\t\t\t// --------------\n\t\t\t\t\t// ` inline code\n\t\t\t\t} else {\n\t\t\t\t\tlet start = i\n\t\t\t\t\tvar codeText = \"\"\n\t\t\t\t\twhile (c) {\n\t\t\t\t\t\tif (c==\"`\") {\n\t\t\t\t\t\t\tif (code[i+1] == \"`\") {\n\t\t\t\t\t\t\t\tif (i == start+1 && codeText[0] == \" \")\n\t\t\t\t\t\t\t\t\tcodeText = codeText.substr(1)\n\t\t\t\t\t\t\t\tscan()\n\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcodeText += c\n\t\t\t\t\t\tscan()\n\t\t\t\t\t}\n\t\t\t\t\taddBlock(options.icode({},codeText))\n\t\t\t\t\tscan()\n\t\t\t\t}\n\t\t\t\t//\n\t\t\t\t//================\n\t\t\t\t// link\n\t\t\t} else if (readLink()) {\n\t\t\t\t//\n\t\t\t\t//=============\n\t\t\t\t// normal char\n\t\t\t} else {\n\t\t\t\taddText(c)\n\t\t\t\tscan()\n\t\t\t}\n\t\t}\n\t\t// END\n\t\tendAll()\n\t\treturn output.node\n\t\t\n\t\t\n\t\t// ###################################\n\t\t\n\t\tfunction readBracketedLink(embed) {\n\t\t\tif (eatChar(\"[\")) {\n\t\t\t\tif (eatChar(\"[\")) {\n\t\t\t\t\t// read url:\n\t\t\t\t\tvar start = i\n\t\t\t\t\tvar part2 = false\n\t\t\t\t\tvar url = readUrl(true)\n\t\t\t\t\tif (eatChar(\"]\")) {\n\t\t\t\t\t\tif (eatChar(\"]\")){\n\t\t\t\t\t\t}else if (eatChar(\"[\"))\n\t\t\t\t\t\t\tpart2 = true\n\t\t\t\t\t}\n\t\t\t\t\tif (embed)\n\t\t\t\t\t\tvar type = urlType(url);\n\t\t\t\t\telse\n\t\t\t\t\t\ttype = 'link';\n\t\t\t\t\tif (type == \"youtube\") {\n\t\t\t\t\t\taddBlock(options.youtube({\"\":url}, preview));\n\t\t\t\t\t\tif (part2)\n\t\t\t\t\t\t\taddText(\"[\") // scary\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartBlock(type, {big: true}, {\"\":url}, preview)\n\t\t\t\t\t\tif (part2)\n\t\t\t\t\t\t\tstack.top().inBrackets = true\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\taddText(url)\n\t\t\t\t\t\t\tendBlock()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true\n\t\t\t\t} else {\n\t\t\t\t\taddText(\"[\")\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false\n\t\t}\n\t\t\n\t\tfunction readEnv() {\n\t\t\tif (!eatChar(\"{\"))\n\t\t\t\treturn false\n\t\t\tstartBlock(null, {})\n\t\t\tlineStart()\n\t\t\t\n\t\t\tvar start = i\n\t\t\tif (eatChar(\"#\")){\n\t\t\t\tvar name = readTagName()\n\t\t\t\tvar props = readProps()\n\t\t\t\t// todo: make this better lol\n\t\t\t\tvar func = tags[name]\n\t\t\t\tif (func && !(name==\"spoiler\" && stackContains(\"spoiler\"))) {\n\t\t\t\t\tstartBlock(func, {}, props)\n\t\t\t\t} else {\n\t\t\t\t\taddBlock(options.invalid(code.substring(start, i), \"invalid tag\"))\n\t\t\t\t}\n\t\t\t\t/*if (displayBlock({type:name}))\n\t\t\t\t  skipNextLineBreak = true; //what does this even do?*/\n\t\t\t}\n\t\t\tlineStart()\n\t\t\t//\teatChar(\"\\n\")\n\t\t\treturn true\n\t\t}\n\t\t\n\t\t// read table cell properties and start cell block, and eat whitespace\n\t\t// assumed to be called when pointing to char after |\n\t\tfunction startCell(row) {\n\t\t\tvar props = {}\n\t\t\tif (eatChar(\"#\"))\n\t\t\t\tObject.assign(props, readProps())\n\t\t\t\n\t\t\tif (props.rs)\n\t\t\t\trow.table.rowspans.push(props.rs-1)\n\t\t\tif (props.cs)\n\t\t\t\trow.cells += props.cs-1\n\t\t\t\n\t\t\tif (row.header)\n\t\t\t\tprops.h = true\n\t\t\t\n\t\t\tstartBlock('cell', {row: row}, props)\n\t\t\twhile (eatChar(\" \")){\n\t\t\t}\n\t\t}\n\n\t\t// split string on first occurance\n\t\tfunction split1(string, sep) {\n\t\t\tvar n = string.indexOf(sep)\n\t\t\tif (n == -1)\n\t\t\t\treturn [string, null]\n\t\t\telse\n\t\t\t\treturn [string.substr(0,n), string.substr(n+sep.length)]\n\t\t}\n\t\t\n\t\tfunction readTagName() {\n\t\t\tvar start = i\n\t\t\twhile (c>=\"a\" && c<=\"z\") {\n\t\t\t\tscan()\n\t\t\t}\n\t\t\tif (i > start)\n\t\t\t\treturn code.substring(start, i)\n\t\t}\n\t\t\n\t\t// read properties key=value,key=value... ended by a space or \\n or } or {\n\t\t// =value is optional and defaults to `true`\n\t\tfunction readProps() {\n\t\t\tvar start = i\n\t\t\tvar end = code.indexOf(\" \", i)\n\t\t\tif (end < 0)\n\t\t\t\tend = code.length\n\t\t\tvar end2 = code.indexOf(\"\\n\", i)\n\t\t\tif (end2 >= 0 && end2 < end)\n\t\t\t\tend = end2\n\t\t\tend2 = code.indexOf(\"}\", i)\n\t\t\tif (end2 >= 0 && end2 < end)\n\t\t\t\tend = end2\n\t\t\tend2 = code.indexOf(\"{\", i)\n\t\t\tif (end2 >= 0 && end2 < end)\n\t\t\t\tend = end2\n\n\n\t\t\trestore(end)\n\t\t\teatChar(\" \")\n\n\t\t\tvar propst = code.substring(start, end)\n\t\t\tvar props = {}\n\t\t\tpropst.split(\",\").forEach(function(x){\n\t\t\t\tvar pair = split1(x, \"=\")\n\t\t\t\tif (pair[1] == null)\n\t\t\t\t\tpair[1] = true\n\t\t\t\tprops[pair[0]] = pair[1]\n\t\t\t})\n\t\t\treturn props\n\t\t}\n\n\t\t// string.repeat doesn't exist\n\t\tfunction addMulti(text, count) {\n\t\t\twhile (count --> 0)\n\t\t\t\taddText(text)\n\t\t}\n\n\t\tfunction readLink() {\n\t\t\tvar embed = eatChar(\"!\")\n\t\t\tif (readBracketedLink(embed) || readPlainLink(embed))\n\t\t\t\treturn true\n\t\t\telse if (embed) {\n\t\t\t\taddText(\"!\")\n\t\t\t\treturn true\n\t\t\t\t//lesson: if anything is eaten, you must return true if it's in the top level if switch block\n\t\t\t}\n\t\t}\n\n\t\tfunction readPlainLink(embed) {\n\t\t\tif (isUrlStart()) {\n\t\t\t\tvar url = readUrl()\n\t\t\t\tvar after = eatChar(\"[\")\n\t\t\t\t\n\t\t\t\tif (embed)\n\t\t\t\t\tvar type = urlType(url);\n\t\t\t\telse\n\t\t\t\t\ttype = 'link';\n\t\t\t\tif (type == \"youtube\") {\n\t\t\t\t\taddBlock(options.youtube({\"\":url}, preview));\n\t\t\t\t\tif (after)\n\t\t\t\t\t\taddText(\"[\") // scary\n\t\t\t\t} else {\n\t\t\t\t\tstartBlock(type, {inBrackets: after}, {\"\":url}, preview)\n\t\t\t\t\tif (!after) {\n\t\t\t\t\t\taddText(url)\n\t\t\t\t\t\tendBlock()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\t\t\n\t\t// closeAll(true) - called at end of document\n\t\t// closeAll(false) - called at end of {} block\n\t\tfunction closeAll(force) {\n\t\t\twhile(stack.length) {\n\t\t\t\tvar top = stack.top()\n\t\t\t\tif (top.type == 'root') {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tif (!force && top.type == null) {\n\t\t\t\t\tendBlock()\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tendBlock()\n\t\t\t}\n\t\t}\n\n\t\t// called at the end of a line (unescaped newline)\n\t\tfunction endLine() {\n\t\t\twhile (1) {\n\t\t\t\tvar top = stack.top()\n\t\t\t\tif (top.type == 'heading' || top.type == 'quote') {\n\t\t\t\t\tendBlock()\n\t\t\t\t} else if (top.type == 'item') {\n\t\t\t\t\tif (top.type == 'item')\n\t\t\t\t\t\tendBlock()\n\t\t\t\t\tvar indent = 0\n\t\t\t\t\twhile (eatChar(\" \"))\n\t\t\t\t\t\tindent++\n\t\t\t\t\t// OPTION 1:\n\t\t\t\t\t// no next item; end list\n\t\t\t\t\tif (c != \"-\") {\n\t\t\t\t\t\twhile (top_is('list')) //should ALWAYS happen at least once\n\t\t\t\t\t\t\tendBlock()\n\t\t\t\t\t\taddMulti(\" \", indent)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscan()\n\t\t\t\t\t\twhile (eatChar(\" \")) {}\n\t\t\t\t\t\t// OPTION 2:\n\t\t\t\t\t\t// next item has same indent level; add item to list\n\t\t\t\t\t\tif (indent == top.level) {\n\t\t\t\t\t\t\tstartBlock('item', {level: indent})\n\t\t\t\t\t\t\t// OPTION 3:\n\t\t\t\t\t\t\t// next item has larger indent; start nested list\t\n\t\t\t\t\t\t} else if (indent > top.level) {\n\t\t\t\t\t\t\tstartBlock('list', {level: indent}, {})\n\t\t\t\t\t\t\tstartBlock('item', {level: indent}) // then made the first item of the new list\n\t\t\t\t\t\t\t// OPTION 4:\n\t\t\t\t\t\t\t// next item has less indent; try to exist 1 or more layers of nested lists\n\t\t\t\t\t\t\t// if this fails, fall back to just creating a new item in the current list\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// TODO: currently this will just fail completely \n\t\t\t\t\t\t\twhile(1) {\n\t\t\t\t\t\t\t\ttop = stack.top()\n\t\t\t\t\t\t\t\tif (top && top.type == 'list') {\n\t\t\t\t\t\t\t\t\tif (top.level <= indent) {\n\t\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tendBlock()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// no suitable list was found :(\n\t\t\t\t\t\t\t\t\t// so just create a new one\n\t\t\t\t\t\t\t\t\tstartBlock('list', {level: indent}, {})\n\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstartBlock('item', {level: indent})\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak //really?\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\taddLineBreak()\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// audio, video, image, youtube\n\t\t//todo: improve this lol\n\t\tfunction urlType(url) {\n\t\t\tif (/(\\.mp3(?!\\w)|\\.ogg(?!\\w)|\\.wav(?!\\w)|#audio$)/.test(url))\n\t\t\t\treturn \"audio\"\n\t\t\tif (/(\\.mp4(?!\\w)|\\.mkv(?!\\w)|#video$)/.test(url))\n\t\t\t\treturn \"video\"\n\t\t\tif (/(?:https?:\\/\\/)?(?:www\\.)?youtu\\.?be(?:\\.com)?\\/?.*(?:watch|embed)?(?:.*v=|v\\/|\\/)([\\w\\-_]+)\\&?/.test(url))\n\t\t\t\treturn \"youtube\"\n\t\t\treturn \"image\"\n\t\t}\n\n\t\t// common code for all text styling tags (bold etc.)\n\t\tfunction doMarkup(type, create) {\n\t\t\tvar symbol = c\n\t\t\tscan()\n\t\t\tif (canStartMarkup(type)) {\n\t\t\t\tstartBlock(type, {})\n\t\t\t} else if (canEndMarkup(type)) {\n\t\t\t\tendBlock()\n\t\t\t} else {\n\t\t\t\taddText(symbol)\n\t\t\t}\n\t\t}\n\t\t// todo: maybe have support for non-ASCII punctuation/whitespace?\n\t\tfunction canStartMarkup(type) {\n\t\t\treturn (\n\t\t\t\t(!code[i-2] || char_in(code[i-2], \" \\t\\n({'\\\"\")) && //prev char is one of these (or start of text)\n\t\t\t\t(c && !char_in(c, \" \\t\\n,'\\\"\")) && //next char is not one of these\n\t\t\t\t!stackContains(type)\n\t\t\t)\n\t\t}\n\t\tfunction canEndMarkup(type) {\n\t\t\treturn (\n\t\t\t\ttop_is(type) && //there is an item to close\n\t\t\t\t!char_in(code[i-2], \" \\t\\n,'\\\"\") && //prev char is not one of these\n\t\t\t\t(!c || char_in(c, \" \\t\\n-.,:!?')}\\\"\")) //next char is one of these (or end of text)\n\t\t\t)\n\t\t}\n\t\tfunction char_in(chr, list) {\n\t\t\treturn chr && list.indexOf(chr) != -1\n\t\t}\n\t\t\n\t\tfunction lineStart() {\n\t\t\tstartOfLine = true\n\t\t\tleadingSpaces = 0\n\t\t}\n\t\t\n\t}\n\n\tParse.lang.bbcode = function(codeArg, preview) {\n\t\tvar noNesting = {\n\t\t\tspoiler:true\n\t\t}\n\t\tvar blocks = {\n\t\t\tb: options.bold,\n\t\t\ti: options.italic,\n\t\t\tu: options.underline,\n\t\t\ts: options.strikethrough,\n\t\t\tsup: options.superscript,\n\t\t\tsub: options.subscript,\n\t\t\th1: function(){return options.heading(1)},\n\t\t\th2: function(){return options.heading(2)},\n\t\t\th3: function(){return options.heading(3)},\n\t\t\ttable: options.table,\n\t\t\ttr: options.row,\n\t\t\ttd: options.cell,\n\t\t\tth: function(arg, opt){\n\t\t\t\treturn options.cell(Object.assign({h:true}, opt))\n\t\t\t},\n\t\t\tcode: false, \n\t\t\talign: options.align,\n\t\t\turl: options.link,//+<VERY special case> (only hardcode when no argument)\n\t\t\tyoutube: true, //<special case>,\n\t\t\taudio: true,\n\t\t\tvideo: true,\n\t\t\timg: true, //<special case>,\n\t\t\tlist: options.list,\n\t\t\tspoiler: options.spoiler,\n\t\t\tquote: options.quote,\n\t\t\tanchor: options.anchor,\n\t\t\titem: options.item,\n\t\t}\n\t\tinit(function() {\n\t\t\ti++\n\t\t\tc = code.charAt(i)\n\t\t}, blocks, codeArg)\n\t\t\n\t\tvar specialBlock = {\n\t\t\turl: function(args, contents){\n\t\t\t\tvar node = options.link({\"\":contents})\n\t\t\t\toptions.append(node, options.text(contents))\n\t\t\t\treturn node\n\t\t\t},\n\t\t\tcode: function(args, contents) {\n\t\t\t\tvar inline = args[\"\"] == 'inline'\n\t\t\t\targs[\"\"] = args.lang\n\t\t\t\tif (inline)\n\t\t\t\t\treturn options.icode(args, contents)\n\t\t\t\t\n\t\t\t\tif (contents[0]==\"\\n\")\n\t\t\t\t\tcontents = contents.substr(1)\n\t\t\t\treturn options.code(args, contents)\n\t\t\t},\n\t\t\tyoutube: function(args, contents) {\n\t\t\t\treturn options.youtube({\"\":contents}, preview)\n\t\t\t},\n\t\t\timg: function(args, contents) {\n\t\t\t\treturn options.image({\"\":contents})\n\t\t\t},\n\t\t\taudio: function(args, contents) {\n\t\t\t\treturn options.audio({\"\":contents})\n\t\t\t},\n\t\t\tvideo: function(args, contents) {\n\t\t\t\treturn options.video({\"\":contents})\n\t\t\t}\n\t\t}\n\n\t\tvar point = 0\n\t\t\n\t\twhile (c) {\n\t\t\t//===========\n\t\t\t// [... tag?\n\t\t\tif (eatChar(\"[\")) {\n\t\t\t\tpoint = i-1\n\t\t\t\t// [/... end tag?\n\t\t\t\tif(eatChar(\"/\")) {\n\t\t\t\t\tvar name = readTagName()\n\t\t\t\t\t// invalid end tag\n\t\t\t\t\tif (!eatChar(\"]\") || !name) {\n\t\t\t\t\t\tcancel()\n\t\t\t\t\t// valid end tag\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// end last item in lists\n\t\t\t\t\t\tif (name == \"list\" && stack.top().type == \"item\")\n\t\t\t\t\t\t\tendBlock(point)\n\t\t\t\t\t\tif (name == stack.top().type) {\n\t\t\t\t\t\t\tendBlock(point)\n\t\t\t\t\t\t\t// eat whitespace between table cells\n\t\t\t\t\t\t\tif (name == 'td' || name == 'th' || name == 'tr') {\n\t\t\t\t\t\t\t\twhile(eatChar(' ')||eatChar('\\n')){\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taddBlock(options.invalid(code.substring(point, i), \"unexpected closing tag\"))\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t// [... start tag?\n\t\t\t\t} else {\n\t\t\t\t\tvar name = readTagName()\n\t\t\t\t\tif (!name || !blocks[name]) {\n\t\t\t\t\t\t// special case [*] list item\n\t\t\t\t\t\tif (eatChar(\"*\") && eatChar(\"]\")) {\n\t\t\t\t\t\t\tif (stack.top().type == \"item\")\n\t\t\t\t\t\t\t\tendBlock(point)\n\t\t\t\t\t\t\tvar top = stack.top()\n\t\t\t\t\t\t\tif (top.type == \"list\") {\n\t\t\t\t\t\t\t\tstartBlock(\"item\", {}, {})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tcancel()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcancel()\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// [tag=...\n\t\t\t\t\t\tvar arg = true, args = {}\n\t\t\t\t\t\tif (eatChar(\"=\")) {\n\t\t\t\t\t\t\tvar start=i\n\t\t\t\t\t\t\tif (eatChar('\"')) {\n\t\t\t\t\t\t\t\tstart++\n\t\t\t\t\t\t\t\twhile (c && c!='\"')\n\t\t\t\t\t\t\t\t\tscan()\n\t\t\t\t\t\t\t\tif (c == '\"') {\n\t\t\t\t\t\t\t\t\targ = code.substring(start, i-1)\n\t\t\t\t\t\t\t\t\tscan()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twhile (c && c!=\"]\" && c!=\" \")\n\t\t\t\t\t\t\t\t\tscan()\n\t\t\t\t\t\t\t\tif (c == \"]\" || c == \" \")\n\t\t\t\t\t\t\t\t\targ = code.substring(start, i)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (eatChar(\" \")) {\n\t\t\t\t\t\t\targs = readArgList() || {}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (arg!=true)\n\t\t\t\t\t\t\targs[\"\"] = arg\n\t\t\t\t\t\tif (eatChar(\"]\")) {\n\t\t\t\t\t\t\tif (specialBlock[name] && !(name == \"url\" && arg!=true)) {\n\t\t\t\t\t\t\t\tvar endTag = \"[/\"+name+\"]\"\n\t\t\t\t\t\t\t\tvar end = code.indexOf(endTag, i)\n\t\t\t\t\t\t\t\tif (end < 0)\n\t\t\t\t\t\t\t\t\tcancel()\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tvar contents = code.substring(i, end)\n\t\t\t\t\t\t\t\t\trestore(end + endTag.length)\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// todo: this can't handle args with caching currently\n\t\t\t\t\t\t\t\t\tvar node = tryGetCached(cache, name, contents, function() {\n\t\t\t\t\t\t\t\t\t\treturn specialBlock[name](args, contents)\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\taddBlock(node)\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (node.block)\n\t\t\t\t\t\t\t\t\t\tskipNextLineBreak = true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (name!=\"item\" && blocks[name] && !(noNesting[name] && stackContains(name))) {\n\t\t\t\t\t\t\t\tif (name == 'tr' || name == 'table') {\n\t\t\t\t\t\t\t\t\twhile(eatChar(' ')||eatChar('\\n')){\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstartBlock(name, {}, args)\n\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\taddBlock(options.invalid(code.substring(point, i), \"invalid tag\"))\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcancel()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (readPlainLink()) {\n\t\t\t} else if (eatChar('\\n')) {\n\t\t\t\taddLineBreak()\n\t\t\t} else {\n\t\t\t\taddText(c)\n\t\t\t\tscan()\n\t\t\t}\n\t\t}\n\t\tendAll()\n\t\treturn output.node\n\t\t\n\t\tfunction cancel() {\n\t\t\trestore(point)\n\t\t\taddText(c)\n\t\t\tscan()\n\t\t}\n\n\t\tfunction readPlainLink() {\n\t\t\tif (isUrlStart()) {\n\t\t\t\tvar url = readUrl()\n\t\t\t\taddBlock(specialBlock.url({},url))\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\tfunction readArgList() {\n\t\t\tvar args = {}\n\t\t\twhile (1) {\n\t\t\t\t// read key\n\t\t\t\tvar start = i\n\t\t\t\twhile (isTagChar(c))\n\t\t\t\t\tscan()\n\t\t\t\tvar key = code.substring(start, i)\n\t\t\t\t// key=...\n\t\t\t\tif (eatChar(\"=\")) {\n\t\t\t\t\t// key=\"...\n\t\t\t\t\tif (eatChar('\"')) {\n\t\t\t\t\t\tstart = i\n\t\t\t\t\t\twhile (c && c!='\"' && c!=\"\\n\")\n\t\t\t\t\t\t\tscan()\n\t\t\t\t\t\tif (eatChar('\"'))\n\t\t\t\t\t\t\targs[key] = code.substring(start, i-2)\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t// key=...\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart = i\n\t\t\t\t\t\twhile (c && c!=\" \" && c!=\"]\" && c!=\"\\n\")\n\t\t\t\t\t\t\tscan()\n\t\t\t\t\t\tif (c == \"]\") {\n\t\t\t\t\t\t\targs[key] = code.substring(start, i)\n\t\t\t\t\t\t\treturn args\n\t\t\t\t\t\t} else if (eatChar(\" \"))\n\t\t\t\t\t\t\targs[key] = code.substring(start, i-1)\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn null\n\t\t\t\t\t}\n\t\t\t\t\t// key ...\n\t\t\t\t} else if (eatChar(\" \")) {\n\t\t\t\t\targs[key] = true\n\t\t\t\t\t// key]...\n\t\t\t\t} else if (c == \"]\") {\n\t\t\t\t\targs[key] = true\n\t\t\t\t\treturn args\n\t\t\t\t\t// key<other char> (error)\n\t\t\t\t} else\n\t\t\t\t\treturn null\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction readTagName() {\n\t\t\tvar start = i\n\t\t\twhile (isTagChar(c))\n\t\t\t\tscan()\n\t\t\treturn code.substring(start, i)\n\t\t}\n\n\t\tfunction isTagChar(c) {\n\t\t\treturn c>=\"a\" && c<=\"z\" || c>=\"A\"&&c<=\"Z\" || c>=\"0\"&&c<=\"9\"\n\t\t}\n\t}\n\t\n\t// \"plain text\" (with autolinker)\n\tParse.fallback = function(text, preview) {\n\t\tvar options = Parse.options\n\t\tvar root = options.root()\n\t\ti = 0\n\t\tcode = text\n\t\toutput = root\n\t\t\n\t\tvar linkRegex = /\\b(?:https?:\\/\\/|sbs:)[-\\w\\$\\.+!*'(),;/\\?:@=&#%]*/g\n\t\tvar result\n\t\tvar out = \"\", last = 0\n\t\twhile (result = linkRegex.exec(text)) {\n\t\t\t// text before link\n\t\t\toptions.append(root, options.text(text.substring(last, result.index)))\n\t\t\t// generate link\n\t\t\tvar link = options.link({\"\": result[0]})\n\t\t\toptions.append(link, options.text(result[0]))\n\t\t\toptions.append(root, link)\n\t\t\t\n\t\t\tlast = result.index + result[0].length\n\t\t}\n\t\t// text after last link (or entire message if no links were found)\n\t\toptions.append(root, options.text(text.substr(last)))\n\t\t\n\t\treturn root.node\n\t}\n\t\n\tParse.parseLang = function(text, lang, preview) {\n\t\ti=0\n\t\tcode = text\n\t\tif (preview) {\n\t\t\tcache = editorCache\n\t\t} else {\n\t\t\tcache = null\n\t\t}\n\t\ttry {\n\t\t\tvar parser = Parse.lang[lang] || Parse.fallback\n\t\t\treturn parser(text, preview)\n\t\t} catch(e) {\n\t\t\ttry {\n\t\t\t\tif (!output) {\n\t\t\t\t\toutput = options.root();\n\t\t\t\t}\n\t\t\t\toptions.append(output, options.error(e, e.stack))\n\t\t\t\toptions.append(output, options.text(code.substr(i)))\n\t\t\t\treturn output.node\n\t\t\t} catch (e) {\n\t\t\t\talert(\"Unrecoverable parser error! please report this!\\n\"+e.stack)\n\t\t\t}\n\t\t}\n\t}\n})()\n\nexport default Parse;","import React, { useEffect, useState } from \"react\";\nimport { useRouteMatch } from \"react-router-dom\";\nimport Parse from \"../parse.js\"\n\nfunction TestPageView(props) {\n  const [content, setContent] = useState(\"owo\");\n  let match = useRouteMatch(\"/sbs-sue-client/#page/:pid\")\n\n  useEffect(() => {\n    console.log(match)\n    fetch(\n      `https://newdev.smilebasicsource.com/api/Content?Ids=${match.params.pid}`\n    )\n      .then(res => res.json())\n      .then(data => {\n        const page = data[0]\n        // eslint-disable-next-line no-undef\n        const output = Parse.parseLang(page.content, page.values.markupLang)\n        let rootElement = document.createElement(\"div\");\n        rootElement.appendChild(output);\n        setContent(rootElement.innerHTML)\n      })\n      .catch(err => console.error(err));\n    setContent(\"Loading...\") ;\n  }, [match.url]); \n\n  return <div style={{\n    width: \"100%\",\n    height: \"100%\",\n    overflow: \"auto\",\n  }}\n  dangerouslySetInnerHTML={{__html: content}} />;\n}\n\nexport default TestPageView;\n","import React from 'react';\n\nfunction Home() {\n    return <div>Hello OwO</div>\n}\n\nexport default Home;","import React, { useState } from \"react\";\r\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\r\nimport \"./App.css\";\r\nimport Sidebar from \"./components/Sidebar.jsx\";\r\nimport TestPageView from \"./components/TestPageView.jsx\";\r\nimport Home from './components/Home.jsx';\r\n\r\nfunction App() {\r\n  const [classState, setClassState] = useState(\"\");\r\n  const [currentPageID, setCurrentPageID] = useState(1829);\r\n\r\n  function toggleHide() {\r\n    if (classState === \"\") setClassState(\"mythehide\");\r\n    else setClassState(\"\");\r\n    console.log(classState);\r\n  }\r\n\r\n  function changePage(newId) {\r\n    setCurrentPageID(newId);\r\n  }\r\n\r\n  return (\r\n    <Router>\r\n      <div className={`App`}>\r\n        <header className=\"App-header\">\r\n          <button onClick={toggleHide}>toggle sidebar view</button>\r\n        </header>\r\n        <main className={classState}>\r\n          <div className=\"content\">\r\n            <Switch>\r\n              <Route path=\"/sbs-sue-client/#page/:pid\" component={TestPageView} />\r\n              <Route path=\"/\" component={Home} />\r\n            </Switch>\r\n          </div>\r\n          <Sidebar changePage={changePage} />\r\n        </main>\r\n      </div>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App.jsx';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}